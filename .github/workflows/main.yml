name: CI

on:
  push:
    branches: [ master ]
  pull_request:
    branches: [ master ]

jobs:
  build:
    runs-on: [windows-latest]

    steps:
    - uses: actions/checkout@v2

    - name: Add msbuild to PATH
      uses: microsoft/setup-msbuild@v1.1

    - name: Setup NuGet.exe for use with actions
      uses: NuGet/setup-nuget@v1


    - name: Restore NuGet packages
      run: nuget restore DevingOps.sln

    - name: Build the Solution
      run: msbuild DevingOps.csproj /p:Configuration=Release /p:DeployOnBuild=true

    - name: GitHub Actions WebDeploy
      # You may pin to the exact commit or the version.
      # uses: cschleiden/webdeploy-action@48a2cdaf8aaa2bc762c12948ada3db14faead320
      uses: cschleiden/webdeploy-action@v1.1.0
      with:
        # Name of an existing website on the IIS machine
        webSiteName: gh-cd-demo.com
        # File path to the package or a folder generated by MSBuild or a compressed archive file.
        package: D:/a/DevingOps/DevingOps/obj/Debug/Package
      

